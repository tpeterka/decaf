<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Decaf: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Decaf
   </div>
   <div id="projectbrief">decoupled dataflows for in-situ high performance workflows</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Decaf Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This document uses the <a href="http://daringfireball.net/projects/markdown/">Markdown</a> syntax.</p>
<h1>Decaf dependencies</h1>
<ul>
<li>C++11</li>
<li>MPI-3</li>
<li>Boost 1.59 or higher</li>
<li>Python 3.0 or higher</li>
<li>Networkx 2.0</li>
<li>CMake 3.0 or higher</li>
<li>CCI 2.1 or higher (optional)</li>
</ul>
<h1>Building Decaf:</h1>
<p>Retrieve the sources of Decaf (in the current directory, e.g.): </p><div class="fragment"><div class="line">git clone https://bitbucket.org/tpeterka1/decaf.git .</div></div><!-- fragment --><p>Decaf is built using CMake. Assuming that you created a build directory, then: </p><div class="fragment"><div class="line">cd path/to/decaf/build</div><div class="line">cmake /path/to/decaf/source \</div><div class="line">-DCMAKE_INSTALL_PREFIX=/path/to/decaf/install \</div><div class="line">-Dtransport_mpi=on \</div></div><!-- fragment --><p>Then, make, install, and set environment variables: </p><div class="fragment"><div class="line">make</div><div class="line">make install</div><div class="line">export DECAF_PREFIX=/path/to/decaf/install</div><div class="line">export LD_LIBRARY_PATH=/path/to/decaf/install/lib:$LD_LIBRARY_PATH</div></div><!-- fragment --><p> (The syntax above is for Bash and Linux; other shells and unixes are similar; eg., the dynamic library path variable is <code>DYLD_LIBRARY_PATH on Mac OSX</code>. You may consider setting the environment variables in .bashrc or .profile)</p>
<h1>Run examples</h1>
<p>Decaf provides several examples of simple workflows. Assuming Decaf was installed following the previous instructions, run the following commands: </p><div class="fragment"><div class="line">cd /path/to/Decaf/install/examples/direct</div><div class="line">python3 linear-2nodes.py</div><div class="line">./linear2.sh</div><div class="line"></div><div class="line">cd /path/to/Decaf/install/examples/direct</div><div class="line">python3 cycle-4nodes.py</div><div class="line">./cycle.sh</div></div><!-- fragment --><h1>Wrapping your project in Python</h1>
<p>The workflow can be hand-coded in C++, but the python instructions below describe an easier way to define the network. The Python program creates a JSON configuration file that Decaf reads.</p>
<p>A short Python script (eg. example.py) can be used to set workflow parameters and run the workflow. </p><div class="fragment"><div class="line"># a small 2-node example, just a producer and consumer</div><div class="line"></div><div class="line"># --- include the following 4 lines each time ---</div><div class="line"></div><div class="line">import networkx as nx</div><div class="line">import os</div><div class="line">import imp</div><div class="line">wf = imp.load_source(&#39;workflow&#39;, os.environ[&#39;DECAF_PREFIX&#39;] + &#39;/python/decaf.py&#39;)</div><div class="line"></div><div class="line"># --- set your options here ---</div><div class="line"></div><div class="line"># path to .so module for dataflow callback functions</div><div class="line">mod_path = os.environ[&#39;DECAF_PREFIX&#39;] + &#39;/examples/direct/mod_linear_2nodes.so&#39;</div><div class="line"></div><div class="line"># define workflow graph</div><div class="line"># 2-node workflow</div><div class="line">#</div><div class="line">#    prod (4 procs) -&gt; con (2 procs)</div><div class="line">#</div><div class="line">#  entire workflow takes 8 procs (2 dataflow procs between producer and consumer)</div><div class="line">#  dataflow can be overlapped, but currently all disjoint procs (simplest case)</div><div class="line"></div><div class="line"># --- Graph definition ---</div><div class="line">prod = wf.Node(&quot;prod&quot;, start_proc=0, nprocs=4, func=&#39;prod&#39;, cmdline=&#39;./linear_2nodes&#39;)</div><div class="line">outPort = prod.addOutputPort(&quot;out&quot;)</div><div class="line"></div><div class="line">con = wf.Node(&quot;con&quot;, start_proc=6, nprocs=2, func=&#39;con&#39;, cmdline=&#39;./linear_2nodes&#39;)</div><div class="line">inPort = con.addInputPort(&quot;in&quot;)</div><div class="line"></div><div class="line">link = wf.Edge(prod.getOutputPort(&quot;out&quot;), con.getInputPort(&quot;in&quot;), start_proc=4, nprocs=2, func=&#39;dflow&#39;,</div><div class="line">        path=mod_path, prod_dflow_redist=&#39;count&#39;, dflow_con_redist=&#39;count&#39;, cmdline=&#39;./linear_2nodes&#39;)</div><div class="line"></div><div class="line"># --- convert the nx graph into a workflow data structure and run the workflow ---</div><div class="line">wf.processGraph(&quot;linear2&quot;)</div></div><!-- fragment --> <h1>Licensing</h1>
<p>Decaf is <a href="https://github.com/tpeterka/decaf/blob/master/COPYING">public domain</a> software.</p>
<h1>Learning more about Decaf:</h1>
<p>See the documents <a href="https://tpeterka.github.io/decaf/">here</a>. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
